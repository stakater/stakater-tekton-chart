name: stakater-main-pr-v1
workspaces:
  - name: source
    volumeClaimTemplate:
      accessModes: ReadWriteOnce
      resourcesRequestsStorage: 1Gi
pipelines:
  tasks:
    - taskName: git-clone
    - taskName: stakater-create-git-tag-v1
    - taskName: stakater-buildah-v1
    - taskName: stakater-comment-on-github-pr-v1
    - taskName: stakater-helm-push-v1
    - taskName: stakater-update-cd-repo-v1
    - taskName: stakater-push-main-tag-v1
triggertemplate:
  serviceAccountName: stakater-tekton-builder
eventlistener:
  serviceAccountName: stakater-tekton-builder
  triggers:
  - name: stakater-pr-cleaner-v1-pullrequest-merge
    ignoreManifest: true
    create: false
  - name: pullrequest
    bindings:
    - ref: stakater-pr-v1
  - name: push
    bindings:
    - ref: stakater-main-v1
